<!DOCTYPE html>
<html lang="fr-tu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Emoty - CrÃ©e de magnifiques motifs d'emojis avec l'aide de l'IA. Dispo sur Android. Hyper respectueux de ta vie privÃ©e et conforme Ã  la COPPA.">
    <meta name="author" content="Christopher Archer">
    <meta name="keywords" content="Emoty, motifs d'emojis, app crÃ©ative, Android, gÃ©nÃ©rateur de motifs IA, conforme COPPA">
    <link rel="alternate" hreflang="en" href="https://emoty.fr/en-GB/">
    <link rel="canonical" href="https://emoty.fr">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap" rel="stylesheet">
    <title>Emoty - CrÃ©ateur de Motifs d'Emojis</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            position: relative;
        }
        .emoty-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
        }
        .emoty-text-container {
            display: flex;
            align-items: flex-start;
        }
        .emoty-text {
            font-family: 'Inter', sans-serif;
            font-weight: 300;
            font-size: 3em;
            color: white;
            letter-spacing: 0.3em;
            text-decoration-color: rgba(255,255,255,0.8);
            text-underline-offset: 8px;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .emoty-accent-line {
            width: 50%;
            height: 3px;
            margin-top: 0px;
            background: linear-gradient(90deg, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.4) 100%);
            border-radius: 2px;
        }
        .tagline {
            font-size: 1.3em;
            margin-top: 10px;
            opacity: 0.95;
        }
        .lang-switch {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .lang-switch a {
            color: white;
            text-decoration: none;
            background: rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            transition: background 0.3s;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .lang-switch a:hover {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.3);
        }
        .home-button {
            position: absolute;
            top: 20px;
            left: 20px;
        }
        .home-button a {
            color: white;
            text-decoration: none;
            background: rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            transition: background 0.3s;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .home-button a:hover {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.3);
        }
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .feature:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        .feature h3 {
            color: #667eea;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .cta {
            text-align: center;
            margin: 40px 0;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            display: inline-block;
            padding: 15px 30px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 30px;
            font-size: 1.1em;
            transition: background 0.3s, transform 0.3s;
            margin: 10px;
        }
        .button:hover {
            background: #764ba2;
            transform: scale(1.05);
        }
        .button.secondary {
            background: #f0f0f0;
            color: #333;
        }
        .button.secondary:hover {
            background: #e0e0e0;
        }
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #ddd;
            margin-top: 40px;
        }
        footer a {
            color: #667eea;
            text-decoration: none;
        }
        footer a:hover {
            text-decoration: underline;
        }

        .emoji-demos {
            display: flex;
            flex-wrap: nowrap;
            gap: clamp(0.5rem, 2vw, 2rem); /* Dynamic spacing between divs */
            width: 100%;
            box-sizing: border-box;
        }

        .emoji-demo {
            font-size: clamp(0.7rem, 2.5vw, 2rem); /* Dynamic font size */
            text-align: center;
            margin: 0; /* Remove margin since we use gap on parent */
            line-height: 1.4;
            flex: 1; /* Equal distribution of space */
            min-width: 0; /* Allow shrinking below content size */
            letter-spacing: clamp(0.05em, 0.5vw, 0.25em); /* Dynamic letter spacing */
            word-spacing: clamp(0.05em, 0.3vw, 0.15em); /* Dynamic word spacing */
        }
        
        .signup-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 40px 0;
        }
        
        .signup-section h2 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .signup-section > p {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        
        .signup-form {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        
        .form-group input[type="email"],
        .form-group input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-sizing: border-box;
        }
        
        .form-group input[type="email"]:focus,
        .form-group input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-group input[type="email"]:invalid {
            border-color: #e74c3c;
        }
        
        .checkbox-container {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            position: relative;
            padding-left: 35px;
            margin-bottom: 0;
        }
        
        .checkbox-container input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        
        .checkmark {
            position: absolute;
            top: 2px;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: #f0f0f0;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .checkbox-container:hover input ~ .checkmark {
            background-color: #e8e8e8;
        }
        
        .checkbox-container input:checked ~ .checkmark {
            background-color: #667eea;
            border-color: #667eea;
        }
        
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }
        
        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }
        
        .checkbox-container .checkmark:after {
            left: 6px;
            top: 2px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        
        .help-text {
            font-size: 0.9em;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }
        
        .help-text a {
            color: #667eea;
            text-decoration: none;
        }
        
        .help-text a:hover {
            text-decoration: underline;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 8px;
            font-weight: 500;
        }
        
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }
        
        .success-message h3 {
            color: #155724;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .success-message p {
            margin-bottom: 10px;
        }
        
        .signup-button {
            width: 100%;
            margin: 20px 0 0 0;
            padding: 15px;
            font-size: 1.1em;
            font-weight: 500;
        }
        
        .signup-button:disabled,
        .signup-button.disabled {
            background: #ccc !important;
            cursor: not-allowed !important;
            transform: none !important;
            opacity: 0.5 !important;
            color: #666 !important;
            border: 1px solid #ddd !important;
        }
        
        .signup-button:disabled:hover,
        .signup-button.disabled:hover {
            background: #ccc !important;
            transform: none !important;
            box-shadow: none !important;
        }
        
        @media (max-width: 600px) {
            .emoty-text { font-size: 2em; }
            .tagline { font-size: 1.1em; }
            .features { grid-template-columns: 1fr; }
            .lang-switch {
                position: absolute;
                top: 15px;
                right: 15px;
            }
            .lang-switch a {
                padding: 6px 12px;
                font-size: 0.9em;
            }
            .home-button {
                position: absolute;
                top: 15px;
                left: 15px;
            }
            .home-button a {
                padding: 6px 12px;
                font-size: 0.9em;
            }
            .signup-section {
                padding: 20px;
            }
            .checkbox-container {
                font-size: 0.95em;
                line-height: 1.4;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            
            <div class="lang-switch">
                <a href="/en-GB/">English</a>
            </div>
            
            <div class="emoty-logo">
                <div class="emoty-text-container">
                    <span class="emoty-text">e m o t y</span>
                    <span>ðŸ’¬</span>
                </div>
                <div class="emoty-accent-line"></div>
            </div>
            <p class="tagline">CrÃ©e de Magnifiques Motifs d'Emojis, avec une Aide Intelligente Dispo</p>
        </header>

        

    <div class="emoji-demos">

        <div class="emoji-demo">
            ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸<br>
            ðŸŒ¸ðŸŒºðŸŒºðŸŒºðŸŒ¸<br>
            ðŸŒ¸ðŸŒºðŸŒ¸ðŸŒºðŸŒ¸<br>
            ðŸŒ¸ðŸŒºðŸŒºðŸŒºðŸŒ¸<br>
            ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸
        </div>
        <div class="emoji-demo">
            ðŸ’«ðŸ’«ðŸ’«ðŸ’«ðŸ’«<br>
            ðŸ’«ðŸ§¡ðŸ§¡ðŸ§¡ðŸ’«<br>
            ðŸ’«ðŸ§¡âœ¨ðŸ§¡ðŸ’«<br>
            ðŸ’«ðŸ§¡ðŸ§¡ðŸ§¡ðŸ’«<br>
            ðŸ’«ðŸ’«ðŸ’«ðŸ’«ðŸ’«
        </div>

        <div class="emoji-demo">
            ðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»<br>
            ðŸŒ»ðŸ’‹ðŸ’‹ðŸ’‹ðŸŒ»<br>
            ðŸŒ»ðŸ’‹ðŸŒ¹ðŸ’‹ðŸŒ»<br>
            ðŸŒ»ðŸ’‹ðŸ’‹ðŸ’‹ðŸŒ»<br>
            ðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»
        </div>

        
    </div>

    <div class="features">
        <div class="feature">
            <h3>&#x2728; Assistance CrÃ©ative</h3>
            <p>LibÃ©rons ta crÃ©ativitÃ©. L'aide est toujours disponible pour gÃ©nÃ©rer un motif Ã  partir d'un texte, ou obtenir des suggestions de noms astucieux pour ton art fini.</p>
        </div>
        
        <div class="feature">
            <h3>&#x1F3A8; 15 Palettes SÃ©lectionnÃ©es</h3>
            <p>Choisis parmi CÅ“urs & Fleurs, Visages Heureux, Ambiance Nature, Animaux Mignons, Espace & Cosmos, et 10 autres collections thÃ©matiques.</p>
        </div>
        
        <div class="feature">
            <h3>&#x1F510; Vie PrivÃ©e Avant Tout</h3>
            <p>Toutes tes donnÃ©es restent sur ton appareil. Aucune info personnelle collectÃ©e. Conforme Ã  la COPPA et safe pour tous les Ã¢ges.</p>
        </div>
        
        <div class="feature">
            <h3>&#x1F4AC; Ton Assistant EmotyBot</h3>
            <p>Ton EmotyBot sympa est toujours lÃ  pour t'aider. Demande des idÃ©es crÃ©atives, trouve des fonctionnalitÃ©s de l'app, ou obtiens des recommandations d'emojis via un simple chat.</p>
        </div>
        
        <div class="feature">
            <h3>&#x1F4E4; Partager & Exporter</h3>
            <p>Sauvegarde en images, imprime en PDF, partage des motifs sous forme de codes, ou exporte toute ta collection en JSON.</p>
        </div>
        
        <div class="feature">
            <h3>&#x1F399; Commandes Vocales</h3>
            <p>CrÃ©e des motifs mains-libres avec des commandes vocales en anglais et en franÃ§ais avec dÃ©tection automatique de la langue.</p>
        </div>
        
        <div class="feature">
            <h3>&#x1F4C4; Notes de Version</h3>
            <p>Reste au courant des derniÃ¨res fonctionnalitÃ©s, amÃ©liorations et corrections de bugs de l'app Android Emoty.</p>
            <p><a href="/changelog/" style="color: #667eea; text-decoration: none; font-weight: 500;">Voir les DerniÃ¨res Mises Ã  Jour â†’</a></p>
        </div>
    </div>

    <div class="cta">
        <h2>RÃ©cupÃ¨re Emoty pour Android</h2>
        <p>Transforme tes emojis en magnifiques motifs. Parfait pour les rÃ©seaux sociaux, les dÃ©cos, ou l'expression crÃ©ative !</p>
        <a href="https://play.google.com/store/apps/details?id=com.carcher.emoty" class="button">
            TÃ©lÃ©charger sur Google Play
        </a>
        <a href="/eli5/" class="button secondary">
            ðŸŽˆ Version SimplifiÃ©e
        </a>
        <a href="/privacy-policy" class="button secondary">
            Politique de ConfidentialitÃ©
        </a>
    </div>

    <div class="signup-section">
        <h2>ðŸ§ª Participe aux Tests Beta</h2>
        <p>Sois parmi les premiers Ã  tester les nouvelles fonctionnalitÃ©s d'Emoty ! Inscris-toi pour recevoir des invitations aux tests beta et des mises Ã  jour exclusives.</p>
        
        <form id="signupForm" class="signup-form">
            <div class="form-group">
                <label for="email">Adresse email :</label>
                <input type="email" id="email" name="email" required 
                       aria-describedby="email-help" 
                       placeholder="ton@email.fr">
                <div id="email-help" class="help-text">Nous utiliserons cette adresse uniquement pour les invitations aux tests</div>
                <div id="email-error" class="error-message" aria-live="polite"></div>
            </div>
            
            <div class="form-group">
                <label for="username">Nom d'utilisateur (optionnel) :</label>
                <input type="text" id="username" name="username" 
                       aria-describedby="username-help" 
                       placeholder="Ton pseudo prÃ©fÃ©rÃ©" 
                       maxlength="50">
                <div id="username-help" class="help-text">Aide-nous Ã  personnaliser tes invitations aux tests (50 caractÃ¨res max)</div>
                <div id="username-error" class="error-message" aria-live="polite"></div>
            </div>
            
            <div class="form-group">
                <label class="checkbox-container">
                    <input type="checkbox" id="consent" name="consent" required aria-describedby="consent-help">
                    <span class="checkmark"></span>
                    J\'accepte de recevoir des emails de test beta d\'Emoty
                </label>
                <div id="consent-help" class="help-text">
                    Tu peux te dÃ©sinscrire Ã  tout moment. Voir notre <a href="/privacy-policy">politique de confidentialitÃ©</a>.
                </div>
                <div id="consent-error" class="error-message" aria-live="polite"></div>
            </div>
            
            <button type="submit" class="button signup-button" id="submitBtn" disabled>
                S\'inscrire aux Tests Beta
            </button>
            
            <div id="signup-success" class="success-message" style="display: none;">
                <h3>ðŸŽ‰ Merci ! Confirme ton inscription</h3>
                <p>Merci de rejoindre le programme beta ! Nous avons envoyÃ© un email de confirmation Ã  <span id="confirmed-email"></span>. 
                Clique sur le lien dans l'email pour finaliser ton inscription aux tests beta.</p>
                <p><strong>Important :</strong> Le lien expire dans 48 heures.</p>
                <button type="button" id="resendBtn" class="button secondary" style="display: none;">
                    Renvoyer l'email de confirmation
                </button>
            </div>
            
            <div id="signup-error" class="error-message" style="display: none;"></div>
        </form>
    </div>


        <footer>
            <p>&copy; 2025 Christopher Archer â€¢ Tous droits rÃ©servÃ©s â€¢ v2.16.1</p>
            <p>
                <a href="/privacy-policy">Politique de ConfidentialitÃ©</a> | 
                <a href="/eli5/">Version SimplifiÃ©e</a> | 
                <a href="/changelog/">Journal des modifications</a> | 
                <a href="mailto:support@emoty.fr">Contact</a>
            </p>
        </footer>
    </div>
    
<script>
/**
 * Emoty Language Detection
 * Automatically redirects users to their preferred language based on browser settings
 */

(function() {
    'use strict';
    
    // Configuration from template
    const config = {
        enabled: true,
        storageKey: 'emoty_language_preference',
        frenchUrl: '/',
        englishUrl: '/en-GB/'
    };
    
    function setLanguagePreference(lang) {
        localStorage.setItem(config.storageKey, lang);
    }

    function redirect(url) {
        if (window.location.href !== url) {
            window.location.href = url;
        }
    }

    // Language switcher event listeners
    document.addEventListener('DOMContentLoaded', function() {
        const langSwitchLink = document.querySelector('.lang-switch a');
        if (langSwitchLink) {
            langSwitchLink.addEventListener('click', function(e) {
                const currentLang = document.documentElement.lang.split('-')[0];
                const targetLang = (currentLang === 'fr') ? 'en' : 'fr';
                setLanguagePreference(targetLang);
            });
        }
    });

    // Main detection logic
    if (config.enabled) {
        const storedPreference = localStorage.getItem(config.storageKey);
        
        if (storedPreference) {
            // User has a preference, redirect if necessary
            if (storedPreference === 'en' && !window.location.pathname.startsWith(config.englishUrl)) {
                redirect(config.englishUrl);
            } else if (storedPreference === 'fr' && window.location.pathname.startsWith(config.englishUrl)) {
                redirect(config.frenchUrl);
            }
        } else {
            // No preference stored, detect from browser
            const userAgent = navigator.userAgent.toLowerCase();
            const isBot = /bot|crawler|spider|crawling/i.test(userAgent);
            if (isBot) return;

            const browserLanguages = navigator.languages || [navigator.language || navigator.userLanguage];
            const prefersFrench = browserLanguages.some(lang => lang.toLowerCase().startsWith('fr'));

            if (prefersFrench && !window.location.pathname.startsWith(config.englishUrl)) {
                setLanguagePreference('fr');
            } else {
                setLanguagePreference('en');
                if (!window.location.pathname.startsWith(config.englishUrl)) {
                    redirect(config.englishUrl);
                }
            }
        }
    }
})();
</script>

    
<script>
/**
 * Emoty Beta Signup with Double Opt-in
 * GDPR-compliant signup form with confirmation email process
 */
(function() {
    'use strict';
    
    // Configuration
    const config = {
        // API endpoints for beta signup
        apiEndpoint: 'https://emoty-privacy-policy-production.up.railway.app/api/beta-signup',
        confirmationApiEndpoint: 'https://emoty-privacy-policy-production.up.railway.app/api/resend-confirmation',
        maxRetries: 3,
        retryDelay: 1000,
        confirmationTimeout: 48 * 60 * 60 * 1000, // 48 hours
        storageKey: 'emoty_signup_data_fr-tu'
    };
    
    // Translations based on locale
    const translations = {
        
        emailRequired: "L\\'adresse email est requise.",
        emailInvalid: 'Veuillez entrer une adresse email valide.',
        consentRequired: 'Tu dois accepter de recevoir des emails pour t\\'inscrire aux tests beta.',
        signupInProgress: 'Inscription en cours...', 
        signupButton: 'S\'inscrire aux Tests Beta',
        resendInProgress: 'Envoi en cours...', 
        resendButton: 'Renvoyer l'email de confirmation',
        resendSuccess: 'Email renvoyÃ© !',
        signupError: 'Une erreur est survenue lors de l\\'inscription. Veuillez rÃ©essayer.',
        emailAlreadyExists: 'Cette adresse email est dÃ©jÃ  inscrite ou invalide.',
        rateLimited: 'Trop de tentatives. Veuillez attendre avant de rÃ©essayer.',
        noSignupFound: 'Aucune inscription en attente trouvÃ©e.',
        resendError: 'Erreur lors du renvoi de l\\'email. Veuillez rÃ©essayer.',
        confirmationSuccess: 'Inscription confirmÃ©e ! Merci de rejoindre le programme beta d\\'Emoty.',
        usernameTooLong: 'Le nom d\\'utilisateur doit faire 50 caractÃ¨res ou moins.'
        
    };
    
    // DOM elements
    let form, emailInput, usernameInput, consentInput, submitBtn, resendBtn;
    let emailError, usernameError, consentError, signupSuccess, signupError, confirmedEmail;
    
    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        initializeElements();
        setupEventListeners();
        checkPendingConfirmation();
    });
    
    function initializeElements() {
        form = document.getElementById('signupForm');
        emailInput = document.getElementById('email');
        usernameInput = document.getElementById('username');
        consentInput = document.getElementById('consent');
        submitBtn = document.getElementById('submitBtn');
        resendBtn = document.getElementById('resendBtn');
        emailError = document.getElementById('email-error');
        usernameError = document.getElementById('username-error');
        consentError = document.getElementById('consent-error');
        signupSuccess = document.getElementById('signup-success');
        signupError = document.getElementById('signup-error');
        confirmedEmail = document.getElementById('confirmed-email');
    }
    
    function setupEventListeners() {
        if (!form) return;
        
        form.addEventListener('submit', handleSubmit);
        emailInput.addEventListener('input', function() {
            clearEmailError();
            updateSubmitButtonState();
        });
        emailInput.addEventListener('blur', function() {
            validateEmail();
            updateSubmitButtonState();
        });
        usernameInput.addEventListener('input', function() {
            clearUsernameError();
            updateSubmitButtonState();
        });
        usernameInput.addEventListener('blur', function() {
            const username = usernameInput.value.trim();
            if (!validateUsername(username)) {
                showUsernameError(translations.usernameTooLong);
            } else {
                clearUsernameError();
            }
            updateSubmitButtonState();
        });
        consentInput.addEventListener('change', function() {
            clearConsentError();
            updateSubmitButtonState();
        });
        
        if (resendBtn) {
            resendBtn.addEventListener('click', handleResendConfirmation);
        }
        
        // Initial button state check
        updateSubmitButtonState();
    }
    
    function handleSubmit(e) {
        e.preventDefault();
        
        if (!validateForm()) {
            return;
        }
        
        const email = emailInput.value.trim();
        const username = usernameInput ? usernameInput.value.trim() : '';
        const consent = consentInput.checked;
        
        submitSignup(email, username, consent);
    }
    
    function updateSubmitButtonState() {
        if (!submitBtn) return;
        
        const isFormValid = isFormValidForSubmission();
        
        if (isFormValid) {
            submitBtn.disabled = false;
            submitBtn.classList.remove('disabled');
            submitBtn.style.opacity = '1';
            submitBtn.style.cursor = 'pointer';
        } else {
            submitBtn.disabled = true;
            submitBtn.classList.add('disabled');
            submitBtn.style.opacity = '0.5';
            submitBtn.style.cursor = 'not-allowed';
        }
    }
    
    function isFormValidForSubmission() {
        // Check email - must be present and valid format
        const email = emailInput.value.trim();
        const emailRegex = /^[\S@]+@[\S@]+\.[\S@]+$/;
        if (!email || !emailRegex.test(email)) {
            return false;
        }
        
        // Check username - if present, must be valid length
        if (usernameInput) {
            const username = usernameInput.value.trim();
            if (!validateUsername(username)) {
                return false;
            }
        }
        
        // Check consent - must be checked
        if (!consentInput.checked) {
            return false;
        }
        
        return true;
    }

    function validateForm() {
        let isValid = true;
        
        // Validate email
        if (!validateEmail()) {
            isValid = false;
        }
        
        // Validate username (optional field)
        if (usernameInput) {
            const username = usernameInput.value.trim();
            if (!validateUsername(username)) {
                showUsernameError(translations.usernameTooLong);
                isValid = false;
            } else {
                clearUsernameError();
            }
        }
        
        // Validate consent
        if (!consentInput.checked) {
            showConsentError(translations.consentRequired);
            isValid = false;
        }
        
        return isValid;
    }
    
    function validateEmail() {
        const email = emailInput.value.trim();
        const emailRegex = /^[\S@]+@[\S@]+\.[\S@]+$/;
        
        if (!email) {
            showEmailError(translations.emailRequired);
            return false;
        }
        
        if (!emailRegex.test(email)) {
            showEmailError(translations.emailInvalid);
            return false;
        }
        
        clearEmailError();
        return true;
    }
    
    function submitSignup(email, username, consent) {
        setFormLoading(true);
        clearErrors();
        
        // Store signup data for potential resend
        const signupData = {
            email: email,
            username: username,
            timestamp: Date.now(),
            confirmed: false
        };
        localStorage.setItem(config.storageKey, JSON.stringify(signupData));
        
        // Prepare the request body
        const requestBody = {
            email: email,
            consent: consent,
            language: 'fr',
            source: 'beta_signup',
            timestamp: new Date().toISOString()
        };
        
        // Include username only if provided
        if (username) {
            requestBody.username = username;
        }
        
        // Make API call to backend
        fetch(config.apiEndpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(requestBody)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('API response:', data);
            if (data && data.success) {
                handleSignupSuccess(email);
            } else {
                throw new Error('API returned unsuccessful response');
            }
        })
        .catch(error => {
            console.error('Signup error:', error);
            // Fallback to simulation if API is not available or server error (development mode)
            if (error.message.includes('Failed to fetch') || 
                error.message.includes('NetworkError') ||
                error.message.includes('HTTP error! status: 500')) {
                console.warn('API not available or server error, using simulation mode');
                setTimeout(() => handleSignupSuccess(email), 1000);
            } else {
                handleSignupError(error);
            }
        });
    }
    
    function handleSignupSuccess(email) {
        console.log('handleSignupSuccess called with email:', email);
        setFormLoading(false);
        
        if (confirmedEmail) {
            confirmedEmail.textContent = email;
        }
        
        // Hide form and show success message
        if (form) {
            form.style.display = 'none';
        }
        
        if (signupSuccess) {
            signupSuccess.style.display = 'block';
        }
        
        // Show resend button after 5 minutes
        setTimeout(() => {
            if (resendBtn) {
                resendBtn.style.display = 'inline-block';
            }
        }, 5 * 60 * 1000);
        
        // Update stored data
        const signupData = JSON.parse(localStorage.getItem(config.storageKey) || '{}');
        signupData.email = email;
        signupData.confirmationSent = Date.now();
        localStorage.setItem(config.storageKey, JSON.stringify(signupData));
    }
    
    function handleSignupError(error) {
        setFormLoading(false);
        
        let errorMessage = translations.signupError;
        
        if (error.message && error.message.includes('400')) {
            errorMessage = translations.emailAlreadyExists;
        } else if (error.message && error.message.includes('429')) {
            errorMessage = translations.rateLimited;
        }
        
        showSignupError(errorMessage);
    }
    
    function handleResendConfirmation() {
        const signupData = JSON.parse(localStorage.getItem(config.storageKey) || '{}');
        
        if (!signupData.email) {
            showSignupError(translations.noSignupFound);
            return;
        }
        
        setResendLoading(true);
        
        // Make resend API call to backend
        fetch(config.confirmationApiEndpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                email: signupData.email,
                language: 'fr'
            })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            setResendLoading(false);
            showResendSuccess();
        })
        .catch(error => {
            // Fallback to simulation if API is not available (development mode)
            if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                console.warn('Resend API not available, using simulation mode');
                setTimeout(() => {
                    setResendLoading(false);
                    showResendSuccess();
                }, 1000);
            } else {
                setResendLoading(false);
                showSignupError(translations.resendError);
            }
        });
    }
    
    function checkPendingConfirmation() {
        const signupData = JSON.parse(localStorage.getItem(config.storageKey) || '{}');
        
        if (signupData.email && signupData.confirmationSent && !signupData.confirmed) {
            const elapsed = Date.now() - signupData.confirmationSent;
            
            if (elapsed < config.confirmationTimeout) {
                // Show pending confirmation state
                confirmedEmail.textContent = signupData.email;
                form.style.display = 'none';
                signupSuccess.style.display = 'block';
                
                // Show resend button if enough time has passed
                if (elapsed > 5 * 60 * 1000 && resendBtn) {
                    resendBtn.style.display = 'inline-block';
                }
            } else {
                // Confirmation expired, clear stored data
                localStorage.removeItem(config.storageKey);
            }
        }
    }
    
    function setFormLoading(loading) {
        if (loading) {
            submitBtn.disabled = true;
            submitBtn.textContent = translations.signupInProgress;
            submitBtn.style.opacity = '0.7';
            submitBtn.style.cursor = 'not-allowed';
        } else {
            submitBtn.textContent = translations.signupButton;
            // Restore validation state instead of automatically enabling
            updateSubmitButtonState();
        }
    }
    
    function setResendLoading(loading) {
        if (!resendBtn) return;
        
        resendBtn.disabled = loading;
        resendBtn.textContent = loading ? translations.resendInProgress : translations.resendButton;
    }
    
    function showResendSuccess() {
        if (!resendBtn) return;
        
        resendBtn.textContent = translations.resendSuccess;
        resendBtn.style.background = '#28a745';
        
        setTimeout(() => {
            resendBtn.textContent = translations.resendButton;
            resendBtn.style.background = '';
            resendBtn.disabled = false;
        }, 3000);
    }
    
    function showEmailError(message) {
        emailError.textContent = message;
        emailInput.style.borderColor = '#e74c3c';
        emailError.setAttribute('aria-live', 'polite');
    }
    
    function clearEmailError() {
        emailError.textContent = '';
        emailInput.style.borderColor = '';
    }
    
    function showConsentError(message) {
        consentError.textContent = message;
    }
    
    function clearConsentError() {
        consentError.textContent = '';
    }
    
    function validateUsername(username) {
        if (username && username.trim().length > 50) {
            return false;
        }
        return true;
    }
    
    function showUsernameError(message) {
        if (usernameError) {
            usernameError.textContent = message;
            usernameInput.style.borderColor = '#e74c3c';
            usernameError.setAttribute('aria-live', 'polite');
        }
    }
    
    function clearUsernameError() {
        if (usernameError) {
            usernameError.textContent = '';
            usernameInput.style.borderColor = '';
        }
    }
    
    function showSignupError(message) {
        signupError.textContent = message;
        signupError.style.display = 'block';
        signupError.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    function clearErrors() {
        clearEmailError();
        clearUsernameError();
        clearConsentError();
        signupError.style.display = 'none';
    }
    
    // Handle confirmation link clicks (if implementing confirmation on same domain)
    function handleConfirmationLink() {
        const urlParams = new URLSearchParams(window.location.search);
        const confirmationToken = urlParams.get('confirm');
        
        if (confirmationToken) {
            // Process confirmation
            const signupData = JSON.parse(localStorage.getItem(config.storageKey) || '{}');
            signupData.confirmed = true;
            signupData.confirmedAt = Date.now();
            localStorage.setItem(config.storageKey, JSON.stringify(signupData));
            
            // Show confirmation success message
            alert(translations.confirmationSuccess);
            
            // Clean up URL
            if (window.history && window.history.replaceState) {
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }
    }
    
    // Check for confirmation on page load
    handleConfirmationLink();
    
})();
</script>

</body>
</html>